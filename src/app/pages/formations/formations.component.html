<section class="formations-section py-5">
  <div class="container">
    <!-- En-t√™te moderne -->
    <div class="page-header">
      <p class="subtitle">D√©couvrez notre catalogue complet</p>
      <h1 class="main-title">
        Toutes nos <span class="highlight">Formations</span>
      </h1>
      <p class="description">
        Explorez notre gamme compl√®te de formations professionnelles en esth√©tique,
        con√ßues pour vous accompagner vers l'excellence.
      </p>
    </div>

<div class="search-bar-container">
  <form (submit)="onSearchSubmit($event)" class="search-form">
    <input
      type="text"
      [(ngModel)]="searchQuery"
      name="search"
      placeholder="Rechercher une formation..."
      class="search-input"
      autocomplete="off"
      (input)="onSearchInput()"
    />
    <!-- Bouton pour vider la recherche -->
    <button
      *ngIf="searchQuery && searchQuery.length > 0"
      type="button"
      class="clear-button"
      (click)="clearSearch()"
      aria-label="Vider la recherche">
      <i class="fas fa-times"></i>
    </button>
    <!-- Bouton de recherche -->
    <button type="submit" class="search-button">
      <i class="fas fa-search"></i>
    </button>
  </form>
</div>
    <!-- √âtats de chargement -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="loading-spinner"></div>
      <h4 class="status-title">Chargement des formations...</h4>
      <p class="status-message">Patientez quelques instants</p>
    </div>

    <!-- √âtat d'erreur -->
    <div *ngIf="errorMessage" class="error-container">
      <div class="status-icon">‚ö†Ô∏è</div>
      <h4 class="status-title">Oups! Une erreur s'est produite</h4>
      <p class="status-message">{{ errorMessage }}</p>
      <button class="retry-button" (click)="loadFormations()">
        <i class="fas fa-redo me-2"></i>R√©essayer
      </button>
    </div>

    <!-- √âtat vide -->
    <div *ngIf="!isLoading && formations.length === 0 && !errorMessage" class="empty-container">
      <div class="status-icon">üîç</div>
      <h4 class="status-title">Aucune formation trouv√©e</h4>
      <p class="status-message">Revenez bient√¥t pour d√©couvrir nos nouveaux programmes!</p>
    </div>

    <!-- Grille des formations (3 par ligne) -->
    <div class="row justify-content-center formations-list" *ngIf="!isLoading && !errorMessage">
  <div class="col-lg-4 col-md-6 formation-card animate-on-scroll"
       *ngFor="let formation of formations; let i = index"
       [style.animation-delay]="getAnimationDelay(i)">
    <div class="card-inner">
      <div class="img-wrap position-relative">
        <img [src]="formation.photoPrincipale"
             [alt]="formation.nom"
             class="formation-img"
             loading="lazy" />

        <!-- Overlay d'interaction -->
        <div class="img-overlay">
          <button class="btn btn-outline-light btn-sm" (click)="voirDetails(formation.slug)">
            <i class="fas fa-eye me-2"></i>Aper√ßu
          </button>
        </div>

        <!-- Badge promo sur image -->
        <span *ngIf="formation.promoActive" class="promo-badge animate-bounce">
          <i class="fas fa-bolt"></i> -{{ formation.pourcentageReduction }}%
        </span>

        <!-- Badge certificat sur image -->
        <span *ngIf="formation.certificatDelivre" class="cert-badge">
          <i class="fas fa-certificate"></i> Certificat
        </span>
      </div>

      <div class="formation-card-body">
        <h3 class="formation-title mb-2">{{ formation.nom }}</h3>
        <div class="desc-short mb-2">{{ formation.description }}</div>

        <!-- Social Proof am√©lior√© -->
        <div class="social-proof mb-2" *ngIf="formation.messageSocialProof || formation.placesRestantes">
          <div class="proof-item" *ngIf="formation.messageSocialProof">
            <i class="fas fa-users text-success"></i>
            <span>{{ formation.messageSocialProof }}</span>
          </div>
          <div class="proof-item places-restantes" *ngIf="formation.placesRestantes">
            <i class="fas fa-hourglass-half text-warning"></i>
            <span class="text-warning fw-bold">{{ formation.placesRestantes }} places restantes</span>
          </div>
        </div>

        <!-- Taux de remplissage am√©lior√© -->
        <div *ngIf="formation.tauxRemplissage !== undefined" class="progress-section mb-3">
          <div class="progress-info d-flex justify-content-between align-items-center mb-1">
            <small class="text-muted">Progression des inscriptions</small>
            <small class="text-beauty-primary fw-bold">{{ formation.tauxRemplissage | number:'1.0-0' }}%</small>
          </div>
          <div class="progress">
            <div class="progress-bar animate-progress"
              [style.width.%]="formation.tauxRemplissage"
              [attr.aria-valuenow]="formation.tauxRemplissage"
              [attr.aria-valuemin]="0"
              [attr.aria-valuemax]="100"></div>
          </div>
        </div>

        <button (click)="voirDetails(formation.slug)" class="btn-en-savoir">
          <span>En savoir plus</span>
          <i class="fas fa-arrow-right ms-2 arrow-icon"></i>
        </button>
      </div>
    </div>
  </div>
</div>

    <!-- Pagination moderne -->
    <nav *ngIf="totalPages > 1" class="pagination-container" aria-label="Navigation des pages">
      <div class="pagination-controls">
        <!-- Bouton pr√©c√©dent -->
        <button class="page-button"
                [disabled]="currentPage === 0"
                (click)="onPageChange(currentPage - 1)"
                aria-label="Page pr√©c√©dente">
          <i class="fas fa-chevron-left"></i>
        </button>

        <!-- Pages -->
        <button *ngFor="let page of getVisiblePages()"
                class="page-button"
                [class.active]="page === currentPage"
                (click)="onPageChange(page)"
                [attr.aria-label]="'Page ' + (page + 1)"
                [attr.aria-current]="page === currentPage ? 'page' : null">
          {{ page + 1 }}
        </button>

        <!-- Bouton suivant -->
        <button class="page-button"
                [disabled]="currentPage === totalPages - 1"
                (click)="onPageChange(currentPage + 1)"
                aria-label="Page suivante">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>

      <!-- Informations de pagination -->
      <div class="pagination-info">
        Page {{ currentPage + 1 }} sur {{ totalPages }}
        ({{ totalElements }} formations au total)
      </div>
    </nav>

    <!-- Call to action moderne -->
    <div class="cta-section">
      <div class="cta-container">
        <h3 class="cta-title">Pr√™t(e) √† commencer votre formation ?</h3>
        <p class="cta-description">
          Contactez-nous d√®s aujourd'hui pour plus d'informations et d√©butez votre parcours vers l'excellence
        </p>
        <div class="cta-buttons">
          <a href="tel:+237000000000"
             class="cta-button"
             aria-label="Appeler pour plus d'informations">
            <i class="fas fa-phone me-2"></i>Appelez-nous
          </a>
          <a href="mailto:contact@beaute-excellence.com"
             class="cta-button outline"
             aria-label="Envoyer un email pour plus d'informations">
            <i class="fas fa-envelope me-2"></i>√âcrivez-nous
          </a>
        </div>
      </div>
    </div>
  </div>
</section>
