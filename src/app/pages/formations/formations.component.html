<section class="formations-section py-5">
  <div class="container">
    <!-- En-t√™te moderne -->
    <div class="page-header">
      <p class="subtitle">D√©couvrez notre catalogue complet</p>
      <h1 class="main-title">
        Toutes nos <span class="highlight">Formations</span>
      </h1>
      <p class="description">
        Explorez notre gamme compl√®te de formations professionnelles en esth√©tique,
        con√ßues pour vous accompagner vers l'excellence.
      </p>
    </div>

    <!-- Barre de recherche -->
    <div class="search-bar-container">
      <form (submit)="onSearchSubmit($event)" class="search-form">
        <input
          type="text"
          [(ngModel)]="searchQuery"
          name="search"
          placeholder="Rechercher une formation..."
          class="search-input"
          autocomplete="off"
          (input)="onSearchInput()"
        />
        <button
          *ngIf="searchQuery && searchQuery.length > 0"
          type="button"
          class="clear-button"
          (click)="clearSearch()"
          aria-label="Vider la recherche">
          <i class="fas fa-times"></i>
        </button>
        <button type="submit" class="search-button">
          <i class="fas fa-search"></i>
        </button>
      </form>
    </div>

    <!-- √âtats de chargement -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="loading-spinner"></div>
      <h4 class="status-title">Chargement des formations...</h4>
    </div>

    <!-- √âtat d'erreur -->
    <div *ngIf="errorMessage" class="error-container">
      <div class="status-icon">‚ö†Ô∏è</div>
      <h4 class="status-title">Oups! Une erreur s'est produite</h4>
      <p class="status-message">{{ errorMessage }}</p>
      <button class="retry-button" (click)="loadFormations()">
        <i class="fas fa-redo me-2"></i>R√©essayer
      </button>
    </div>

    <!-- √âtat vide -->
    <div *ngIf="!isLoading && formations.length === 0 && !errorMessage" class="empty-container">
      <div class="status-icon">üîç</div>
      <h4 class="status-title">Aucune formation trouv√©e</h4>
      <p class="status-message">Revenez bient√¥t pour d√©couvrir nos nouveaux programmes!</p>
    </div>

    <!-- Liste des formations (3 colonnes desktop, 1 colonne mobile) -->
    <div class="formations-list" *ngIf="!isLoading && !errorMessage">
      <div class="formation-card"
           *ngFor="let formation of formations; let i = index"
           [style.animation-delay]="getAnimationDelay(i)">
        <div class="card-inner">
          <!-- Image -->
          <div class="img-wrap">
            <img [src]="formation.photoPrincipale"
                 [alt]="formation.nom"
                 class="formation-img"
                 loading="lazy" />

            <div class="img-overlay">
              <button class="btn-apercu" (click)="voirDetails(formation.slug)">
                <i class="fas fa-eye me-2"></i>Aper√ßu
              </button>
            </div>

            <!-- Badges -->
            <span *ngIf="formation.promoActive" class="promo-badge">
              <i class="fas fa-bolt"></i> -{{ formation.pourcentageReduction }}%
            </span>
            <span *ngIf="formation.certificatDelivre" class="cert-badge">
              <i class="fas fa-certificate"></i>
            </span>
          </div>

          <!-- Contenu -->
          <div class="formation-card-body">
            <h3 class="formation-title">{{ formation.nom }}</h3>
            <p class="desc-short">{{ formation.description }}</p>

            <!-- Social Proof simplifi√© -->
            <div class="info-row" *ngIf="formation.messageSocialProof || formation.placesRestantes">
              <span *ngIf="formation.messageSocialProof" class="info-item">
                <i class="fas fa-users"></i> {{ formation.messageSocialProof }}
              </span>
              <span *ngIf="formation.placesRestantes" class="info-item warning">
                <i class="fas fa-hourglass-half"></i> {{ formation.placesRestantes }} places
              </span>
            </div>

            <!-- Barre de progression -->
            <div *ngIf="formation.tauxRemplissage !== undefined" class="progress-wrap">
              <div class="progress-bar-bg">
                <div class="progress-bar-fill"
                     [style.width.%]="formation.tauxRemplissage"></div>
              </div>
              <span class="progress-text">{{ formation.tauxRemplissage | number:'1.0-0' }}%</span>
            </div>

            <button (click)="voirDetails(formation.slug)" class="btn-en-savoir">
              En savoir plus
              <i class="fas fa-arrow-right"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <nav *ngIf="totalPages > 1" class="pagination-container">
      <div class="pagination-controls">
        <button class="page-btn"
                [disabled]="currentPage === 0"
                (click)="onPageChange(currentPage - 1)">
          <i class="fas fa-chevron-left"></i>
        </button>

        <button *ngFor="let page of getVisiblePages()"
                class="page-btn"
                [class.active]="page === currentPage"
                (click)="onPageChange(page)">
          {{ page + 1 }}
        </button>

        <button class="page-btn"
                [disabled]="currentPage === totalPages - 1"
                (click)="onPageChange(currentPage + 1)">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>

      <div class="pagination-info">
        Page {{ currentPage + 1 }} sur {{ totalPages }} ({{ totalElements }} formations)
      </div>
    </nav>

    <!-- Call to action -->
    <div class="cta-section">
      <div class="cta-container">
        <h3 class="cta-title">Pr√™t(e) √† commencer votre formation ?</h3>
        <p class="cta-description">
          Contactez-nous d√®s aujourd'hui pour plus d'informations
        </p>
        <div class="cta-buttons">
          <a href="tel:+237000000000" class="cta-btn">
            <i class="fas fa-phone"></i> Appelez-nous
          </a>
          <a href="mailto:contact@beaute-excellence.com" class="cta-btn outline">
            <i class="fas fa-envelope"></i> √âcrivez-nous
          </a>
        </div>
      </div>
    </div>
  </div>
</section>
